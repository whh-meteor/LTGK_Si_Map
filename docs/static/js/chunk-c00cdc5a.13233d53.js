(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c00cdc5a"],{"06c5":function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));r("a630"),r("fb6a"),r("b0c0"),r("d3b7"),r("ac1f"),r("00b4"),r("25f0"),r("3ca3");var n=r("6b75");function o(e,t){if(e){if("string"==typeof e)return Object(n["a"])(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Object(n["a"])(e,t):void 0}}},1:function(e,t){},2:function(e,t){},3:function(e,t){},"33a8":function(e,t,r){"use strict";r("9b57")},"429a":function(e,t){function r(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}r.keys=function(){return[]},r.resolve=r,e.exports=r,r.id="429a"},"67bc":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},o=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{attrs:{id:"map"}})])}],i=r("8bd3"),a=i["a"],c=(r("33a8"),r("2877")),s=Object(c["a"])(a,n,o,!1,null,"e711d672",null);t["default"]=s.exports},"6b75":function(e,t,r){"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}r.d(t,"a",(function(){return n}))},"84c3":function(e,t,r){var n=r("74e8");n("Uint16",(function(e){return function(t,r,n){return e(this,t,r,n)}}))},"8bd3":function(e,t,r){"use strict";(function(e){var n=r("b85c");r("99af"),r("d81d"),r("ace4"),r("d3b7"),r("3ca3"),r("84c3"),r("9a8c"),r("a975"),r("735e"),r("c1ac"),r("d139"),r("3a7b"),r("d5d6"),r("82f8"),r("e91f"),r("60bd"),r("5f96"),r("3280"),r("3fcc"),r("ca91"),r("25a1"),r("cd26"),r("3c5d"),r("2954"),r("649e"),r("219c"),r("170b"),r("b39a"),r("72f7"),r("159b"),r("ddb0");t["a"]={data:function(){return{viewer:null,scene:null,globe:null,MAX_SHORT:32767}},mounted:function(){e.Ion.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJlMjA3MDk1Ni05YTUxLTQ1YTItYTgxNS1iZTQwODM4NDVmOTciLCJpZCI6MjI1NjE0LCJpYXQiOjE3MTk4MjYxNDR9.nMeglmI4UqBSGUtKT2g6oegxXgBYvR1ATaZ34rrN5OI",this.viewer=new e.Viewer("map",{terrainProvider:e.createWorldTerrain({requestWaterMask:!0,requestVertexNormals:!0})}),this.scene=this.viewer.scene,this.globe=this.scene.globe,this.viewer.imageryLayers.addImageryProvider(new e.TileCoordinatesImageryProvider),this.scene.screenSpaceCameraController.enableCollisionDetection=!1,this.viewer.scene.globe._surface._tileProvider._debug.wireframe=!0,this.globe.translucency.frontFaceAlphaByDistance=new e.NearFarScalar(400,0,800,1),this.viewer.camera.flyTo({destination:e.Cartesian3.fromDegrees(117.096,36.206),complete:function(){}}),this.Load()},methods:{Load:function(){var t=this,r=this.viewer;r.entities.removeAll();r.scene,r.scene.globe;var n=[],o=r.scene.globe._surface._tileProvider._quadtree._tilesToRender;o.forEach((function(t){n.push(t),e.Cesium3DTileset})),this.MAX_SHORT=32767;var i=r.terrainProvider,a=(new e.Request({throttle:!0,throttleByServer:!0}),[{x:6759,y:1222},{x:6760,y:1222},{x:6761,y:1222},{x:6759,y:1223},{x:6760,y:1223},{x:6761,y:1223}]),c=12,s=this;i.readyPromise.then((function(){s.requestMultipleTiles(a,c,i).then((function(e){var r=e.map((function(e,t){return s.processTileData(e,a[t],c)}));console.log("所有瓦片的处理结果:",r);var n=t.createObjFileContent(r);s.download("terrain.obj",n)})).catch((function(e){console.error("Error in requestMultipleTiles:",e)}))}))},requestTileData:function(e,t,r,n){return new Promise((function(o,i){o(n.requestTileGeometry(e,t,r))}))},requestMultipleTiles:function(e,t,r){var o,i=[],a=Object(n["a"])(e);try{for(a.s();!(o=a.n()).done;){var c=o.value,s=this.requestTileData(c.x,c.y,t,r);i.push(s)}}catch(l){a.e(l)}finally{a.f()}return console.log("Promises array:",i),Promise.all(i)},processTileData:function(t,r,n){console.log("地形数据--："),console.log(t);var o=(new e.GeographicTilingScheme).tileXYToRectangle(r.x,r.y,n),i=this.MAX_SHORT,a=t._minimumHeight,c=t._maximumHeight,s=t._indices,l=t._quantizedVertices,u=l.length/3,f=[],d=[];console.log(l);for(var h=0;h<u;h++){var v=l[h],g=l[h+u],m=l[h+2*u],b=v/i,p=g/i,y=e.Math.lerp(o.west,o.east,b),w=e.Math.lerp(o.south,o.north,p),C=e.Math.lerp(a,c,m/i),T=new e.Cartographic(y,w,C),M=e.Cartographic.toCartesian(T);f.push([M.x,M.y,C])}for(var D=0;D<s.length;D+=3)d.push([s[D],s[D+1],s[D+2]]);console.log("Vertices:",f),console.log("Faces:",d);for(var _=[],A=0;A<s.length;A++)_.push(s[A]);new Uint16Array(_),new e.EntityCollection;for(var O=0;O<d.length;O++){var x=[f[d[O][0]][0],f[d[O][0]][1],f[d[O][0]][2]+37e5,f[d[O][1]][0],f[d[O][1]][1],f[d[O][1]][2]+37e5,f[d[O][2]][0],f[d[O][2]][1],f[d[O][2]][2]+37e5],I=new e.Cartesian3(x[0],x[1],x[2]),E=new e.Cartesian3(x[3],x[4],x[5]),j=new e.Cartesian3(x[6],x[7],x[8]),S=e.Cartographic.fromCartesian(I),q=e.Cartographic.fromCartesian(E),P=e.Cartographic.fromCartesian(j),k=e.Math.toDegrees(S.longitude),N=e.Math.toDegrees(S.latitude),R=f[d[O][0]][2],U=e.Math.toDegrees(q.longitude),J=e.Math.toDegrees(q.latitude),H=f[d[O][1]][2],L=e.Math.toDegrees(P.longitude),X=e.Math.toDegrees(P.latitude),Y=f[d[O][2]][2];this.viewer.entities.add({name:"三角面",polygon:{hierarchy:e.Cartesian3.fromDegreesArrayHeights([k,N,R,U,J,H,L,X,Y]),perPositionHeight:!0,material:e.Color.fromCssColorString("#23B8BA").withAlpha(.3),outline:!0,outlineColor:e.Color.WHITE}})}return this.viewer.zoomTo(this.viewer.entities),{vertices:f,faces:d}},createObjFileContent:function(e){var t="",r=0;return e.forEach((function(e){e.vertices.forEach((function(e){t+="v ".concat(e[0]," ").concat(e[1]," ").concat(e[2],"\n")})),e.faces.forEach((function(e){t+="f ".concat(e[0]+1+r," ").concat(e[1]+1+r," ").concat(e[2]+1+r,"\n")})),r+=e.vertices.length})),t},download:function(e,t){var r=document.createElement("a");r.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),r.setAttribute("download",e),r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r)}},beforeDestroy:function(){this.viewer.terrainProvider=new e.EllipsoidTerrainProvider}}}).call(this,r("ec35"))},"9b57":function(e,t,r){},b85c:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));r("a4d3"),r("e01a"),r("d28b"),r("d3b7"),r("3ca3"),r("ddb0");var n=r("06c5");function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Object(n["a"])(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return c=e.done,e},e:function(e){s=!0,a=e},f:function(){try{c||null==r["return"]||r["return"]()}finally{if(s)throw a}}}}}}]);