(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ba2d0d50"],{"07e3":function(e,t,n){"use strict";(function(e){var r=n("2909"),o=(n("d81d"),n("ace4"),n("d3b7"),n("5cc6"),n("84c3"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("159b"),n("e097"));t["a"]={name:"Home",data:function(){return{viewer:null,heading:0,offset:null,entity:null}},mounted:function(){this.init()},methods:{init:function(){e.Ion.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJlMjA3MDk1Ni05YTUxLTQ1YTItYTgxNS1iZTQwODM4NDVmOTciLCJpZCI6MjI1NjE0LCJpYXQiOjE3MTk4MjYxNDR9.nMeglmI4UqBSGUtKT2g6oegxXgBYvR1ATaZ34rrN5OI",this.viewer=new e.Viewer("map",{terrainProvider:e.createWorldTerrain({requestWaterMask:!0,requestVertexNormals:!0})}),this.viewer.scene.globe.depthTestAgainstTerrain=!0,this.viewer.scene.screenSpaceCameraController.minimumZoomDistance=-1e3,this.viewer.scene.camera.constrainedAxis=e.Cartesian3.UNIT_Z,this.viewer.scene.screenSpaceCameraController.enableCollisionDetection=!1,this.entity=this.viewer.entities.add({position:e.Cartesian3.fromDegrees(120,33),point:{color:e.Color.RED,pixelSize:10}}),this.loadGeoJsonData("/json/T8_Trans.geojson",5e5),this.loadGeoJsonData("/json/T9_Trans.geojson",6e5),this.loadGeoJsonData("/json/T10_Trans.geojson",7e5),this.loadGeoJsonData("/json/T13_Trans.geojson",8e5),this.useTranslucencyMask()},reset:function(){var t=this.viewer.scene,n=t.globe,r=this.viewer.scene.imageryLayers.get(0);n.showGroundAtmosphere=!0,n.baseColor=e.Color.BLUE,n.translucency.enabled=!1,n.translucency.frontFaceAlpha=1,n.undergroundColor=e.Color.BLACK,n.translucency.rectangle=void 0,r.colorToAlpha=void 0},useTranslucencyMask:function(){var t=this.viewer.scene,n=t.globe,r=this.viewer.scene.imageryLayers.get(0);n.showGroundAtmosphere=!1,n.baseColor=e.Color.TRANSPARENT,n.translucency.enabled=!0,n.undergroundColor=void 0,r.colorToAlpha=new e.Color(0,0,0),r.colorToAlphaThreshold=.2},useTranslucencyRectangle:function(){var t=this.viewer.scene,n=t.globe;this.viewer.scene.imageryLayers.get(0);n.translucency.enabled=!0,n.undergroundColor=void 0,n.translucency.frontFaceAlpha=.25,n.translucency.rectangle=e.Rectangle.fromDegrees(120,30,140,45)},loadGeoJsonData:function(e,t){var n=this,r=e;fetch(r).then((function(e){return e.json()})).then((function(e){var r=e.features.map((function(e){var n=e.geometry.coordinates;return[n[0],n[1],n[2]-t]}));n.createSurfaceFromPoints(r)}))},createSurfaceFromPoints:function(t){for(var n=this.generateInterpolatedPoints(t),i=o["a"].from(n.map((function(e){return[e[0],e[1]]}))),a=i.triangles,s=[],c=[],u=[],l=n.map((function(e){return e[2]})),h=Math.min.apply(Math,Object(r["a"])(l)),f=Math.max.apply(Math,Object(r["a"])(l)),d=0;d<a.length;d+=3){var m=[a[d],a[d+1],a[d+2]],p=m[0],v=m[1],g=m[2],y=n[p],b=n[v],w=n[g];s.push(e.Cartesian3.fromDegrees(y[0],y[1],y[2])),s.push(e.Cartesian3.fromDegrees(b[0],b[1],b[2])),s.push(e.Cartesian3.fromDegrees(w[0],w[1],w[2]));var C=this.getColorFromHeight(y[2],h,f),T=this.getColorFromHeight(b[2],h,f),A=this.getColorFromHeight(w[2],h,f);c.push(C[0],C[1],C[2],C[3]),c.push(T[0],T[1],T[2],T[3]),c.push(A[0],A[1],A[2],A[3]),u.push(u.length,u.length+1,u.length+2)}var D=new e.Geometry({attributes:{position:new e.GeometryAttribute({componentDatatype:e.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:e.Cartesian3.packArray(s)}),color:new e.GeometryAttribute({componentDatatype:e.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,values:new Uint8Array(c),normalize:!0})},indices:new Uint16Array(u),primitiveType:e.PrimitiveType.TRIANGLES,boundingSphere:e.BoundingSphere.fromPoints(s)}),I=new e.PerInstanceColorAppearance({flat:!0,translucent:!1,renderState:{depthTest:{enabled:!0},lineWidth:Math.min(2,this.viewer.scene.maximumAliasedLineWidth)}}),j=new e.Primitive({geometryInstances:new e.GeometryInstance({geometry:D}),appearance:I,asynchronous:!1});this.viewer.scene.primitives.add(j)},getColorFromHeight:function(t,n,r){var o=(t-n)/(r-n);return e.Color.fromHsl(.6*(1-o),1,.5,1).toBytes()},generateInterpolatedPoints:function(e){for(var t=[],n=0;n<e.length-1;n++){for(var r=e[Math.max(n-1,0)],o=e[n],i=e[n+1],a=e[Math.min(n+2,e.length-1)],s=0;s<=1;s+=.2){var c=this.catmullRomInterpolate(r,o,i,a,s);if(t.push(c),t.length>=1e4)break}if(t.length>=1e4)break}return t},catmullRomInterpolate:function(e,t,n,r,o){var i=o*o,a=i*o,s=.5*(2*t[0]+(-e[0]+n[0])*o+(2*e[0]-5*t[0]+4*n[0]-r[0])*i+(-e[0]+3*t[0]-3*n[0]+r[0])*a),c=.5*(2*t[1]+(-e[1]+n[1])*o+(2*e[1]-5*t[1]+4*n[1]-r[1])*i+(-e[1]+3*t[1]-3*n[1]+r[1])*a),u=.5*(2*t[2]+(-e[2]+n[2])*o+(2*e[2]-5*t[2]+4*n[2]-r[2])*i+(-e[2]+3*t[2]-3*n[2]+r[2])*a);return[s,c,u]},addGeological:function(){var t=this,n="/json/T8_Trans.geojson";fetch(n).then((function(e){return e.json()})).then((function(n){var r=new e.PointPrimitiveCollection;t.viewer.scene.primitives.add(r),n.features.forEach((function(t){var n=t.geometry.coordinates,o=e.Cartesian3.fromDegrees(n[0],n[1],-1*n[2]);r.add(new e.PointPrimitive({position:o,color:e.Color.RED,pixelSize:1}))}))}))},rotationCamera:function(e){this.heading+=e},beginRotate:function(){var e=this;this.viewer.zoomTo(this.entity,this.offset).then((function(){e.viewer.clock.onTick.addEventListener(e.rotate)}))},stop:function(){this.viewer.clock.onTick.removeEventListener(this.rotate),this.viewer.scene.screenSpaceCameraController.enableInputs=!0},rotate:function(){this.heading+=.1,this.offset=new e.HeadingPitchRange(e.Math.toRadians(this.heading),-e.Math.toRadians(30),1e3),this.viewer.zoomTo(this.entity,this.offset),this.viewer.scene.screenSpaceCameraController.enableInputs=!1}}}}).call(this,n("ec35"))},1:function(e,t){},2:function(e,t){},2909:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("6b75");function o(e){if(Array.isArray(e))return Object(r["a"])(e)}n("a4d3"),n("e01a"),n("d28b"),n("a630"),n("d3b7"),n("3ca3"),n("ddb0");function i(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var a=n("06c5");function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e){return o(e)||i(e)||Object(a["a"])(e)||s()}},"2d95":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{attrs:{id:"map"}},[n("div",{staticClass:"pane"},[n("a",{attrs:{href:"#"},on:{click:function(t){return e.rotationCamera(5)}}},[e._v("旋转5")]),n("a",{attrs:{href:"#"},on:{click:function(t){return e.rotationCamera(-5)}}},[e._v("旋转-5")]),n("a",{attrs:{href:"#"},on:{click:function(t){return e.stop()}}},[e._v("停止旋转")]),n("a",{attrs:{href:"#"},on:{click:function(t){return e.beginRotate()}}},[e._v("开始旋转")])]),n("div",{attrs:{id:"toolbar"}})])])},o=[],i=n("07e3"),a=i["a"],s=(n("e663"),n("2877")),c=Object(s["a"])(a,r,o,!1,null,"62f57a41",null);t["default"]=c.exports},3:function(e,t){},"3c7f":function(e,t,n){},"429a":function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="429a"},"5cc6":function(e,t,n){var r=n("74e8");r("Uint8",(function(e){return function(t,n,r){return e(this,t,n,r)}}))},"84c3":function(e,t,n){var r=n("74e8");r("Uint16",(function(e){return function(t,n,r){return e(this,t,n,r)}}))},e663:function(e,t,n){"use strict";n("3c7f")}}]);