(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3ee6b841","chunk-4dcf318c"],{1:function(e,t){},2:function(e,t){},3:function(e,t){},"327b":function(e,t,n){},"40f9":function(e,t,n){"use strict";(function(e){n("caad"),n("d3b7"),n("f8d7");t["a"]={name:"Home",data:function(){return{viewer:null,heading:0,offset:null,entity:null}},mounted:function(){this.init()},methods:{init:function(){this.viewer=new e.Viewer("map",{animation:!1,homeButton:!0,geocoder:!0,baseLayerPicker:!0,timeline:!0,fullscreenButton:!0,scene3DOnly:!1,infoBox:!0,sceneModePicker:!0,navigationInstructionsInitiallyVisible:!0,navigationHelpButton:!0,selectionIndicator:!0,imageryProvider:new e.WebMapTileServiceImageryProvider({url:"http://t0.tianditu.com/img_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=img&tileMatrixSet=w&TileMatrix={TileMatrix}&TileRow={TileRow}&TileCol={TileCol}&style=default&format=tiles&tk=19b72f6cde5c8b49cf21ea2bb4c5b21e",layer:"tdtBasicLayer",style:"default",format:"image/jpeg",tileMatrixSetID:"GoogleMapsCompatible",show:!1,mininumLevel:0,maximumLevel:16})}),this.entity=this.viewer.entities.add({position:e.Cartesian3.fromDegrees(114,30),point:{color:e.Color.RED,pixelSize:10}})},DrawPoints:function(){var t=this;return new Promise((function(n,i){var o=t.viewer,r=[],a=new e.ScreenSpaceEventHandler(o.canvas);a.setInputAction((function(n){var i=t.getCatesian3FromPX(n.position);if(i){o.entities.add({position:i,point:{color:e.Color.RED,pixelSize:10}});var a=e.Cartographic.fromCartesian(i),s=e.Math.toDegrees(a.longitude),c=e.Math.toDegrees(a.latitude),l=e.Math.toDegrees(a.height);r.push({lng:s,lat:c,height:l})}}),e.ScreenSpaceEventType.LEFT_CLICK),a.setInputAction((function(){a.destroy(),n(r)}),e.ScreenSpaceEventType.RIGHT_CLICK)}))},DrawPolyline:function(){var t=this;return new Promise((function(n,i){var o=t.viewer,r=[],a=(o.entities.add({Id:"drawingPolyline",name:"画线",polyline:{positions:new e.CallbackProperty((function(){return r}),!1),width:2,material:e.Color.RED}}),o.entities.add({polyline:{positions:new e.CallbackProperty((function(){return s&&c?[s,c]:[]}),!1),width:2,material:e.Color.RED.withAlpha(.5)}})),s=null,c=null,l=new e.ScreenSpaceEventHandler(o.canvas);l.setInputAction((function(n){var i=t.getCatesian3FromPX(n.position);i&&(r.push(i),s=i,o.entities.add({position:i,point:{color:e.Color.BLUE,pixelSize:10}}))}),e.ScreenSpaceEventType.LEFT_CLICK),l.setInputAction((function(e){c=t.getCatesian3FromPX(e.endPosition)}),e.ScreenSpaceEventType.MOUSE_MOVE),l.setInputAction((function(){l.destroy(),o.entities.remove(a),n(r)}),e.ScreenSpaceEventType.LEFT_DOUBLE_CLICK)}))},DrawCircle:function(){var t=this;return new Promise((function(n,i){var o=t.viewer,r=null,a=10;o.scene.globe.depthTestAgainstTerrain=!1;var s=o.entities.add({id:"drawingCircle",name:"画圆",ellipse:{semiMinorAxis:new e.CallbackProperty((function(){return a}),!1),semiMajorAxis:new e.CallbackProperty((function(){return a}),!1),material:e.Color.BLUE.withAlpha(.2),outline:!0,outlineColor:e.Color.RED,outlineWidth:2,fill:!0}}),c=new e.ScreenSpaceEventHandler(o.canvas);c.setInputAction((function(n){var i=t.getCatesian3FromPX(n.position);i&&null===r&&(r=i,s.position=r,o.entities.add({position:i,point:{color:e.Color.RED,pixelSize:10}}))}),e.ScreenSpaceEventType.LEFT_CLICK),c.setInputAction((function(n){if(r){var i=t.getCatesian3FromPX(n.endPosition);if(i){var o=e.Cartesian3.distance(r,i);a=o}}}),e.ScreenSpaceEventType.MOUSE_MOVE),c.setInputAction((function(){if(null!==r&&a>0){c.destroy();var t=e.Cartographic.fromCartesian(r),i=e.Math.toDegrees(t.longitude),o=e.Math.toDegrees(t.latitude);n({center:{lng:i,lat:o},radius:a})}}),e.ScreenSpaceEventType.LEFT_DOUBLE_CLICK)}))},DrawRectangle:function(){var t=this,n=[];return new Promise((function(i,o){var r=t.viewer,a=null,s=null,c=(r.entities.add({id:"drawingRectangle",name:"画矩形",rectangle:{coordinates:new e.CallbackProperty((function(){if(null!==a&&null!==s){var t=a.longitude,n=a.latitude,i=s.longitude,o=s.latitude;return new e.Rectangle(t,o,i,n)}}),!1),material:e.Color.BLUE.withAlpha(.2),closeTop:!0,closeBottom:!1}}),new e.ScreenSpaceEventHandler(r.canvas));c.setInputAction((function(n){var i=t.getCatesian3FromPX(n.position);i&&(null===a&&(a=e.Cartographic.fromCartesian(i)),r.entities.add({position:i,point:{color:e.Color.RED,pixelSize:10}}))}),e.ScreenSpaceEventType.LEFT_CLICK),c.setInputAction((function(n){a&&(s=e.Cartographic.fromCartesian(t.getCatesian3FromPX(n.endPosition)))}),e.ScreenSpaceEventType.MOUSE_MOVE),c.setInputAction((function(){if(null!==a&&null!==s){c.destroy();var t=e.Math.toDegrees(a.longitude),o=e.Math.toDegrees(a.latitude),r=e.Math.toDegrees(s.longitude),l=e.Math.toDegrees(s.latitude);n.push({lng:t,lat:o}),n.push({lng:r,lat:o}),n.push({lng:r,lat:l}),n.push({lng:t,lat:l}),n.push(n[0]),i(n)}}),e.ScreenSpaceEventType.LEFT_DOUBLE_CLICK)}))},DrawPolygon:function(t){var n=this,i=[];return new Promise((function(o,r){var a=n.viewer,s=[],c=(a.entities.add({id:"drawingPolygon",name:"画多边形",polygon:{hierarchy:new e.CallbackProperty((function(){return new e.PolygonHierarchy(s)}),!1),material:e.Color.BLUE.withAlpha(.2),perPositionHeight:t&&t.ground||!1}}),a.entities.add({id:"drawingLine",name:"画线",polyline:{positions:new e.CallbackProperty((function(){return s}),!1),width:3,material:e.Color.GREEN}})),l=new e.ScreenSpaceEventHandler(a.canvas);l.setInputAction((function(t){var o=n.getCatesian3FromPX(t.position);if(o){s.push(o.clone()),1===s.length&&s.push(o.clone()),a.entities.add({position:o,point:{color:e.Color.RED,pixelSize:10}});var r=o.clone(),c=e.Cartographic.fromCartesian(r);i.push([e.Math.toDegrees(c.longitude),e.Math.toDegrees(c.latitude),c.height])}}),e.ScreenSpaceEventType.LEFT_CLICK),l.setInputAction((function(e){var t=n.getCatesian3FromPX(e.endPosition);s.length>=2&&t&&t.x&&(s.pop(),s.push(t))}),e.ScreenSpaceEventType.MOUSE_MOVE),l.setInputAction((function(){var t=s[s.length-1];a.entities.add({position:t,point:{color:e.Color.RED,pixelSize:10}}),s.push(s[0]),l.destroy(),o(i),n.EditPolygon(s,i,c)}),e.ScreenSpaceEventType.LEFT_DOUBLE_CLICK)}))},EditPolygon:function(t,n,i){var o=this,r=this.viewer,a=[],s=new e.ScreenSpaceEventHandler(r.canvas);s.setInputAction((function(i){var s=o.getCatesian3FromPX(i.position);if(s){t.push(s.clone()),1===t.length&&t.push(s.clone());var c=r.entities.add({id:"point"+t.length,position:s,point:{color:e.Color.RED,pixelSize:10}});a.push(c);var l=s.clone(),u=e.Cartographic.fromCartesian(l);n.push([e.Math.toDegrees(u.longitude),e.Math.toDegrees(u.latitude),u.height])}}),e.ScreenSpaceEventType.LEFT_CLICK),s.setInputAction((function(e){var n=o.getCatesian3FromPX(e.endPosition);t.length>=2&&n&&n.x&&(t.pop(),t.push(n))}),e.ScreenSpaceEventType.MOUSE_MOVE),s.setInputAction((function(){t[t.length-1];if(s.destroy(),t.length>1){t.pop(),n.pop(),n.push(n[0]);var c=r.entities.getById("point"+(t.length+1));c&&r.entities.remove(c);var l=r.entities.getById("point1");l&&r.entities.remove(l)}r.entities.remove(i);var u=null,p=-1,d=new e.ScreenSpaceEventHandler(r.canvas);d.setInputAction((function(t){var n=r.scene.pick(t.position);e.defined(n)&&a.includes(n.id)&&(u=n.id,p=a.indexOf(u),alert("禁用摄像机控制"),r.scene.screenSpaceCameraController.enableRotate=!0,r.scene.screenSpaceCameraController.enableTranslate=!1,r.scene.screenSpaceCameraController.enableZoom=!0,r.scene.screenSpaceCameraController.enableTilt=!1,r.scene.screenSpaceCameraController.enableLook=!1)}),e.ScreenSpaceEventType.LEFT_DOWN),d.setInputAction((function(e){if(u){var n=o.getCatesian3FromPX(e.endPosition);n&&-1!==p&&(u.position=n,t[p]=n,0!==p&&p!==t.length-2||(t[t.length-1]=n,a[t.length-1].position.setValue(n)))}}),e.ScreenSpaceEventType.MOUSE_MOVE),d.setInputAction((function(){u=null,p=-1,r.scene.screenSpaceCameraController.enableRotate=!0,r.scene.screenSpaceCameraController.enableTranslate=!0,r.scene.screenSpaceCameraController.enableZoom=!0,r.scene.screenSpaceCameraController.enableTilt=!0,r.scene.screenSpaceCameraController.enableLook=!0}),e.ScreenSpaceEventType.LEFT_UP)}),e.ScreenSpaceEventType.LEFT_DOUBLE_CLICK)},getCatesian3FromPX:function(t){if(this.viewer&&t){var n=this.viewer.scene.drillPick(t),i=null,o=!1,r=!1;for(var a in n){var s=n[a];if((s&&s.primitive instanceof e.Cesium3DTileFeature||s&&s.primitive instanceof e.Cesium3DTileset||s&&s.primitive instanceof e.Model)&&(o=!0),o&&(this.viewer.scene.pick(t),i=this.viewer.scene.pickPosition(t),i)){var c=e.Cartographic.fromCartesian(i);c.height<0&&(c.height=0);var l=e.Math.toDegrees(c.longitude),u=e.Math.toDegrees(c.latitude),p=c.height;i=this.transformWGS84ToCartesian({lng:l,lat:u,alt:p})}}var d=this.viewer.terrainProvider instanceof e.EllipsoidTerrainProvider;if(!o&&!d){var h=this.viewer.scene.camera.getPickRay(t);if(!h)return null;i=this.viewer.scene.globe.pick(h,this.viewer.scene),r=!0}if(o||r||!d||(i=this.viewer.scene.camera.pickEllipsoid(t,this.viewer.scene.globe.ellipsoid)),i){var f=this.transformCartesianToWGS84(i);return f.alt<0&&(i=this.transformWGS84ToCartesian(f,.1)),i}return!1}},transformWGS84ToCartesian:function(t,n){if(this.viewer)return t?e.Cartesian3.fromDegrees(t.lng||t.lon,t.lat,t.alt=n||t.alt,e.Ellipsoid.WGS84):e.Cartesian3.ZERO},transformCartesianToWGS84:function(t){if(this.viewer&&t){var n=e.Ellipsoid.WGS84,i=n.cartesianToCartographic(t);return{lng:e.Math.toDegrees(i.longitude),lat:e.Math.toDegrees(i.latitude),alt:i.height}}},rotationCamera:function(e){this.heading+=e},beginRotate:function(){var e=this;this.viewer.zoomTo(this.entity,this.offset).then((function(){e.viewer.clock.onTick.addEventListener(e.rotate)}))},stop:function(){this.viewer.clock.onTick.removeEventListener(this.rotate),this.viewer.scene.screenSpaceCameraController.enableInputs=!0},rotate:function(){this.heading+=.1,this.offset=new e.HeadingPitchRange(e.Math.toRadians(this.heading),-e.Math.toRadians(30),1e3),this.viewer.zoomTo(this.entity,this.offset),this.viewer.scene.screenSpaceCameraController.enableInputs=!1}}}}).call(this,n("ec35"))},"429a":function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="429a"},"69c4":function(e,t,n){"use strict";n("327b")},"6c6f":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{attrs:{id:"map"}}),n("div",{staticClass:"pane"},[n("a",{attrs:{href:"#"},on:{click:function(t){return e.rotationCamera(5)}}},[e._v("旋转5")]),n("a",{attrs:{href:"#"},on:{click:function(t){return e.rotationCamera(-5)}}},[e._v("旋转-5")]),n("a",{attrs:{href:"#"},on:{click:function(t){return e.stop()}}},[e._v("停止旋转")]),n("a",{attrs:{href:"#"},on:{click:function(t){return e.beginRotate()}}},[e._v("开始旋转")]),n("a",{attrs:{href:"#"},on:{click:function(t){return e.DrawPoints()}}},[e._v("绘制点")]),n("a",{attrs:{href:"#"},on:{click:function(t){return e.DrawPolyline()}}},[e._v("绘制线")]),n("a",{attrs:{href:"#"},on:{click:function(t){return e.DrawCircle()}}},[e._v("绘制圆")]),n("a",{attrs:{href:"#"},on:{click:function(t){return e.DrawRectangle()}}},[e._v("绘制矩形")]),n("a",{attrs:{href:"#"},on:{click:function(t){return e.DrawPolygon()}}},[e._v("绘制多边形")])])])},o=[],r=n("40f9"),a=r["a"],s=(n("effc"),n("2877")),c=Object(s["a"])(a,i,o,!1,null,"0724897d",null);t["default"]=c.exports},d7e2:function(e,t,n){},effc:function(e,t,n){"use strict";n("d7e2")},f8d7:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticStyle:{width:"100%",height:"800px"},attrs:{id:"map"}}),n("div",{staticClass:"pane"},[n("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.startEdit(t)}}},[e._v("开始编辑")]),n("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.endEdit(t)}}},[e._v("结束编辑")])])])},o=[],r=n("18b7"),a={name:"MapComponent",data:function(){return{polygon:null}},mounted:function(){this.initMapTalk()},methods:{initMapTalk:function(){var e=new r["t"]("map",{center:[-.113049,51.498568],zoom:14,baseLayer:new r["H"]("base",{urlTemplate:"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",subdomains:["a","b","c","d"],attribution:'&copy; <a href="http://osm.org">OpenStreetMap</a> contributors, &copy; <a href="https://carto.com/">CARTO</a>'})});this.polygon=new r["C"]([[[-.131049,51.498568],[-.107049,51.498568],[-.107049,51.493568],[-.131049,51.493568],[-.131049,51.498568]]],{visible:!0,editable:!0,cursor:"pointer",draggable:!1,dragShadow:!1,drawOnAxis:null,symbol:{lineColor:"#34495e",lineWidth:2,polygonFill:"rgb(135,196,240)",polygonOpacity:.6}}),new r["J"]("vector",this.polygon).addTo(e),this.startEdit()},startEdit:function(){this.polygon.startEdit()},endEdit:function(){this.polygon.endEdit()}}},s=a,c=(n("69c4"),n("2877")),l=Object(c["a"])(s,i,o,!1,null,"724e02aa",null);t["default"]=l.exports}}]);