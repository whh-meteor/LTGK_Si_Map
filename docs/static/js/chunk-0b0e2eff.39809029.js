(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0b0e2eff"],{1:function(e,t){},2:function(e,t){},3:function(e,t){},3152:function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},n=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{attrs:{id:"map"}})])}],a=i("c1bd"),o=a["a"],s=(i("7045"),i("2877")),l=Object(s["a"])(o,r,n,!1,null,"79361e3a",null);t["default"]=l.exports},"429a":function(e,t){function i(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}i.keys=function(){return[]},i.resolve=i,e.exports=i,i.id="429a"},7045:function(e,t,i){"use strict";i("9919")},9919:function(e,t,i){},c1bd:function(e,t,i){"use strict";(function(e){i("d81d"),i("d3b7"),i("159b");var r=i("595b");t["a"]={data:function(){return{viewer:null,scene:null,globe:null}},mounted:function(){e.Ion.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJlMjA3MDk1Ni05YTUxLTQ1YTItYTgxNS1iZTQwODM4NDVmOTciLCJpZCI6MjI1NjE0LCJpYXQiOjE3MTk4MjYxNDR9.nMeglmI4UqBSGUtKT2g6oegxXgBYvR1ATaZ34rrN5OI",this.viewer=new e.Viewer("map",{terrainProvider:e.createWorldTerrain({requestWaterMask:!0,requestVertexNormals:!0})}),this.scene=this.viewer.scene,this.globe=this.scene.globe,this.viewer.imageryLayers.addImageryProvider(new e.TileCoordinatesImageryProvider),this.scene.screenSpaceCameraController.enableCollisionDetection=!1,this.globe.translucency.frontFaceAlphaByDistance=new e.NearFarScalar(400,0,800,1),this.viewer.camera.flyTo({destination:e.Cartesian3.fromDegrees(117.096,36.206),complete:function(){}}),this.DrawRectangle()},methods:{DrawRectangle:function(){var t=this,i=[];return new Promise((function(r,n){var a=t.viewer,o=null,s=null,l=(a.entities.add({id:"drawingRectangle",name:"画矩形",rectangle:{coordinates:new e.CallbackProperty((function(){if(null!==o&&null!==s){var t=o.longitude,i=o.latitude,r=s.longitude,n=s.latitude;return new e.Rectangle(t,n,r,i)}}),!1),material:e.Color.BLUE.withAlpha(.2),closeTop:!0,closeBottom:!1}}),new e.ScreenSpaceEventHandler(a.canvas));l.setInputAction((function(i){var r=t.getCatesian3FromPX(i.position);r&&(null===o&&(o=e.Cartographic.fromCartesian(r)),a.entities.add({position:r,point:{color:e.Color.RED,pixelSize:10}}))}),e.ScreenSpaceEventType.LEFT_CLICK),l.setInputAction((function(i){o&&(s=e.Cartographic.fromCartesian(t.getCatesian3FromPX(i.endPosition)))}),e.ScreenSpaceEventType.MOUSE_MOVE),l.setInputAction((function(){if(null!==o&&null!==s){l.destroy();var n=e.Math.toDegrees(o.longitude),a=e.Math.toDegrees(o.latitude),c=e.Math.toDegrees(s.longitude),u=e.Math.toDegrees(s.latitude);i.push({lng:n,lat:a}),i.push({lng:c,lat:a}),i.push({lng:c,lat:u}),i.push({lng:n,lat:u}),i.push(i[0]),r(i),t.ceatRectangularPoints(i)}}),e.ScreenSpaceEventType.LEFT_DOUBLE_CLICK)}))},ceatRectangularPoints:function(t){console.log(t);var i=e.Rectangle.fromDegrees(t[0].lng,t[2].lat,t[2].lng,t[0].lat);console.log("1-区域范围"),console.log(i);var r=20,n=20,a=this.viewer.terrainProvider;console.log("2- terrainProvider地形"),console.log(a);for(var o=[],s=0;s<n;s++)for(var l=0;l<r;l++){var c=e.Math.lerp(i.west,i.east,l/(r-1)),u=e.Math.lerp(i.south,i.north,s/(n-1));o.push(e.Cartographic.fromRadians(c,u))}console.log("3- positions"),console.log(o),this.giveHeight(a,o)},giveHeight:function(t,i){var n=this;e.sampleTerrainMostDetailed(t,i).then((function(t){var i=t.map((function(t){return r["point"]([e.Math.toDegrees(t.longitude),e.Math.toDegrees(t.latitude),t.height],{z:t.height})}));console.log("4- points"),console.log(i);var a=r["featureCollection"](i),o=r["tin"](a,"z");o.features.forEach((function(t,i){var r=t.geometry.coordinates[0],a=[t.properties.a,t.properties.b,t.properties.c],o=r.map((function(t,i){return e.Cartesian3.fromDegrees(t[0],t[1],a[i])})),s=o[0],l=o[1],c=o[2],u=n.calculateSlopeAndAspect(s,l,c),h=u.slope,g=h/90,p=1,f=.5,d=1,v=e.Color.fromHsl(g,p,f).withAlpha(d);n.viewer.entities.add({name:"三角面",id:"triangle"+i,polygon:{hierarchy:[o[0],o[1],o[2]],heightReference:e.HeightReference.CLAMP_TO_GROUND,perPositionHeight:!0,material:v,outline:!0,outlineColor:e.Color.GREEN}})}));var s=i.map((function(t){var i=t.geometry.coordinates,r=e.Cartographic.fromDegrees(i[0],i[1],i[2]);return e.Cartographic.toCartesian(r)})),l=new e.PointPrimitiveCollection;s.forEach((function(t){l.add({position:t,color:e.Color.RED,pixelSize:5})})),n.viewer.scene.primitives.add(l)}))},getCatesian3FromPX:function(t){if(this.viewer&&t){var i=this.viewer.scene.drillPick(t),r=null,n=!1,a=!1;for(var o in i){var s=i[o];if((s&&s.primitive instanceof e.Cesium3DTileFeature||s&&s.primitive instanceof e.Cesium3DTileset||s&&s.primitive instanceof e.Model)&&(n=!0),n&&(this.viewer.scene.pick(t),r=this.viewer.scene.pickPosition(t),r)){var l=e.Cartographic.fromCartesian(r);l.height<0&&(l.height=0);var c=e.Math.toDegrees(l.longitude),u=e.Math.toDegrees(l.latitude),h=l.height;r=this.transformWGS84ToCartesian({lng:c,lat:u,alt:h})}}var g=this.viewer.terrainProvider instanceof e.EllipsoidTerrainProvider;if(!n&&!g){var p=this.viewer.scene.camera.getPickRay(t);if(!p)return null;r=this.viewer.scene.globe.pick(p,this.viewer.scene),a=!0}if(n||a||!g||(r=this.viewer.scene.camera.pickEllipsoid(t,this.viewer.scene.globe.ellipsoid)),r){var f=this.transformCartesianToWGS84(r);return f.alt<0&&(r=this.transformWGS84ToCartesian(f,.1)),r}return!1}},transformWGS84ToCartesian:function(t,i){if(this.viewer)return t?e.Cartesian3.fromDegrees(t.lng||t.lon,t.lat,t.alt=i||t.alt,e.Ellipsoid.WGS84):e.Cartesian3.ZERO},transformCartesianToWGS84:function(t){if(this.viewer&&t){var i=e.Ellipsoid.WGS84,r=i.cartesianToCartographic(t);return{lng:e.Math.toDegrees(r.longitude),lat:e.Math.toDegrees(r.latitude),alt:r.height}}},calculateSlopeAndAspect:function(t,i,r){var n=e.Cartesian3.subtract(t,i,new e.Cartesian3),a=e.Cartesian3.subtract(i,r,new e.Cartesian3),o=new e.Cartesian3;e.Cartesian3.cross(n,a,o),e.Cartesian3.normalize(o,o);var s=new e.Cartesian3((t.x+i.x+r.x)/3,(t.y+i.y+r.y)/3,(t.z+i.z+r.z)/3),l=e.Cartesian3.normalize(s,new e.Cartesian3);e.Cartesian3.dot(o,l)<0&&e.Cartesian3.negate(o,o);var c=Math.acos(e.Cartesian3.dot(o,l)),u=e.Math.toDegrees(c);return u>90&&(u=180-u),{slope:u}}},beforeDestroy:function(){this.viewer.terrainProvider=new e.EllipsoidTerrainProvider}}}).call(this,i("ec35"))}}]);